<div *ngIf="isOpen()" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" (click)="close()">
<div class="bg-white dark:bg-slate-900 rounded-xl w-full max-w-5xl mx-4" (click)="$event.stopPropagation()">
<div class="px-6 py-4 bg-teal-600 flex justify-between"><h2 class="text-2xl font-bold text-white">Selecionar Produto</h2><button (click)="close()" class="text-white">X</button></div>
<div class="p-4"><input type="text" [(ngModel)]="searchTerm" placeholder="Pesquisar por SKU, nome..." (ngModelChange)="searchTerm.set($event)" class="w-full px-4 py-2 border rounded"></div>
<div class="p-6 max-h-96 overflow-auto">
<div *ngIf="loading()" class="text-center"><div class="w-12 h-12 border-4 border-teal-600 border-t-transparent rounded-full animate-spin mx-auto"></div></div>
<div *ngIf="!loading() && filteredProducts.length > 0" class="grid md:grid-cols-2 gap-3">
<div *ngFor="let p of filteredProducts" (click)="selectProduct(p)" class="p-4 border-2 rounded cursor-pointer" [class.border-teal-600]="selectedProduct()?.id === p.id" [class.bg-teal-50]="selectedProduct()?.id === p.id">
<div class="font-bold text-lg">{{p.name}}</div>
<div class="text-sm text-gray-600">SKU: {{p.sku}}</div>
<div class="text-sm">Pre√ßo: R$ {{p.price | number:'1.2-2'}}</div>
<div *ngIf="p.stockQuantity" class="text-sm">Estoque: {{p.stockQuantity}}</div>
</div>
</div>
</div>
<div class="px-6 py-4 border-t flex justify-end gap-3">
<button (click)="close()" class="px-4 py-2 bg-gray-200 rounded">Cancelar</button>
<button (click)="confirm()" [disabled]="!selectedProduct()" class="px-4 py-2 bg-teal-600 text-white rounded disabled:opacity-50">Confirmar</button>
</div>
</div>
</div>
